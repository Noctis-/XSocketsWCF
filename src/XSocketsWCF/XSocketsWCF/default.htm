<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="/Scripts/jXSockets.2.0.3.js" type="text/javascript"></script>
    <script src="/Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    
    <script type="text/javascript">

        var ws = null;
        $(function () {
            ws = new XSockets.WebSocket("ws://127.0.0.1:4502/Generic");
            
            //Just write to the console on open
            ws.bind(XSockets.Events.open, function (client) {
                console.log('OPEN', client);
            });
            
            //Just in case ;)
            ws.bind(XSockets.Events.onError, function (err) {
                console.log('ERROR', err);
            });

            //Subscribe the OnUserJoined event 
            ws.bind('OnUserJoined', function (msg) {
                $('#info').prepend($("<p>").text(msg.Message));
            });

            //Faking a room signin with AJAX
            $('#signin').bind('click', function (e) {
                $.getJSON('http://localhost:1377/roomservice/joinroom/'+$('#name').val(), function (d) {
                    $('#info').prepend($("<p>").text('WCF message: ' + d));                    
                });
            });
        });

    </script>
</head>
    <body>
        <div><strong>Open a few windows to make it more fun!</strong></div>
        <input type="text" placeholder="Name here..." value="Ken" id="name"/>
        <button id="signin">Click Me To Fake A RoomSignIn</button>
        <label>Or just open another window with (<i>http://localhost:1377/roomservice/joinroom/yournamehere</i>) as location</label>
        <div id="info"></div>
    </body>
</html>
